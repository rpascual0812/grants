<div class="main-content">
    <form [formGroup]="form" (ngSubmit)="handleSave()">
        <div class="row">
            <div class="col-12 mb-3">
                <div class="card bg-gray-100">
                    <div class="card-body">
                        <p class="card-title text-dark font-weight-bold">
                            Please provide three names and contact information of References
                        </p>

                        <div
                            formArrayName="application_reference"
                            *ngFor="let item of formContactReferences.controls; index as i"
                            [attr.data-index]="i"
                            class="row"
                        >
                            <ng-container [formGroupName]="i">
                                <div class="col-12 col-md-3">
                                    <div class="form-group my-3">
                                        <label class="font-weight-bold text-dark">Person {{ i + 1 }}</label>
                                        <input
                                            formControlName="name"
                                            type="text"
                                            class="form-control border rounded-1 p-1"
                                            [ngClass]="{
                                                'is-invalid':
                                                    submitted && formContactReferences.at(i).get('name')?.errors
                                            }"
                                        />
                                        <div *ngIf="submitted && formContactReferences.at(i).get('name')?.errors">
                                            <div
                                                *ngIf="formContactReferences.at(i).get('name')?.errors?.['required']"
                                                class="text-sm text-danger"
                                            >
                                                Person Name is required
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-12 col-md-3">
                                    <div class="form-group my-3">
                                        <label class="font-weight-bold text-dark">Contact</label>
                                        <input
                                            formControlName="contact_number"
                                            type="tel"
                                            class="form-control border rounded-1 p-1"
                                            [ngClass]="{
                                                'is-invalid':
                                                    submitted &&
                                                    formContactReferences.at(i).get('contact_number')?.errors
                                            }"
                                        />
                                        <div
                                            *ngIf="
                                                submitted && formContactReferences.at(i).get('contact_number')?.errors
                                            "
                                        >
                                            <div
                                                *ngIf="formContactReferences.at(i).get('contact_number')?.errors?.['required']"
                                                class="text-sm text-danger"
                                            >
                                                Contact Number is required
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-12 col-md-3">
                                    <div class="form-group my-3">
                                        <label class="font-weight-bold text-dark">Email Address</label>
                                        <input
                                            formControlName="email_address"
                                            type="email"
                                            class="form-control border rounded-1 p-1"
                                            [ngClass]="{
                                                'is-invalid':
                                                    submitted &&
                                                    formContactReferences.at(i).get('email_address')?.errors
                                            }"
                                        />
                                        <div
                                            *ngIf="
                                                submitted && formContactReferences.at(i).get('email_address')?.errors
                                            "
                                        >
                                            <div
                                                *ngIf="formContactReferences.at(i).get('email_address')?.errors?.['email']"
                                                class="text-sm text-danger"
                                            >
                                                Invalid email
                                            </div>

                                            <div
                                                *ngIf="formContactReferences.at(i).get('email_address')?.errors?.['required']"
                                                class="text-sm text-danger"
                                            >
                                                Email is required
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-12 col-md-3">
                                    <div class="form-group my-3">
                                        <label class="font-weight-bold text-dark">Organization Name</label>
                                        <input
                                            formControlName="organization_name"
                                            type="text"
                                            class="form-control border rounded-1 p-1"
                                            [ngClass]="{
                                                'is-invalid':
                                                    submitted &&
                                                    formContactReferences.at(i).get('organization_name')?.errors
                                            }"
                                        />
                                        <div
                                            *ngIf="
                                                submitted &&
                                                formContactReferences.at(i).get('organization_name')?.errors
                                            "
                                        >
                                            <div
                                                *ngIf="formContactReferences.at(i).get('organization_name')?.errors?.['required']"
                                                class="text-sm text-danger"
                                            >
                                                Organization Name is required
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </ng-container>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="d-flex justify-content-center">
            <button
                class="btn btn-white text-capitalize m-1"
                (click)="handleBack()"
                type="button"
                [disabled]="processing"
            >
                Back
            </button>
            <button class="btn btn-dark-blue text-capitalize m-1" [disabled]="processing">Save</button>
        </div>
    </form>
</div>
